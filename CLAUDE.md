# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

EZDM is a music player web app built with React, TypeScript, and Vite. It's designed to catalog and play EDM liveset recordings, with a focus on importing music metadata from external sources.

## Development Commands

### Running the app
```bash
npm run dev       # Start dev server on http://localhost:3000
npm run build     # Production build
npm run preview   # Preview production build
```

### Prerequisites
- Node.js required
- Set `GEMINI_API_KEY` in `.env.local` before running

### Import Utility
```bash
npx ts-node import-script.ts    # Run import script to scrape album data from URLs
```
The import script ([import-script.ts](import-script.ts)) uses Axios and Cheerio to scrape music catalog metadata from edmliveset.com URLs and generates TypeScript data files.

## Architecture

### Core Data Flow

1. **Data Layer** ([types.ts](types.ts))
   - `Track`: Individual song with id, title, artist, duration, artwork, url
   - `Album`: Collection of tracks with metadata
   - `Playlist` & `BrowseCategory`: Supporting types

2. **State Management** ([App.tsx](App.tsx))
   - App-level state manages:
     - Current page navigation (Home/Search/Library/Profile)
     - Active track and album playback
     - Player visibility and track index
   - Uses React callbacks for track playback: `handlePlayTrack`, `handleNextTrack`, `handlePrevTrack`

3. **Page-based Routing**
   - Manual routing via state (no react-router)
   - Pages: [HomePage.tsx](pages/HomePage.tsx), [SearchPage.tsx](pages/SearchPage.tsx), [LibraryPage.tsx](pages/LibraryPage.tsx), [ProfilePage.tsx](pages/ProfilePage.tsx), [PlayerPage.tsx](pages/PlayerPage.tsx)
   - Navigation via [BottomNav.tsx](components/BottomNav.tsx)

4. **Import System**
   - [import.ts](import.ts): `importAlbumFromUrl()` function scrapes web pages for album data
   - Parses HTML using Cheerio to extract title, artist, artwork, and track listings
   - Supports timestamp formats `[MM:SS] Track Name` and numbered lists
   - [import-script.ts](import-script.ts): Batch imports multiple URLs and generates [new-data.ts](new-data.ts)

### Path Aliases
- `@/*` maps to project root (configured in [tsconfig.json](tsconfig.json) and [vite.config.ts](vite.config.ts))

### Environment Variables
The Vite config exposes `GEMINI_API_KEY` as both `process.env.API_KEY` and `process.env.GEMINI_API_KEY` to the client.

### Data Sources
- Static data in [data.ts](data.ts) (trendingNow, madeForYou, newReleases)
- Imported data in [new-data.ts](new-data.ts) (generated by import script)
